<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Cute+Font&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <title>절세미남미녀상 테스트</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- Go to www.addthis.com/dashboard to customize your tools -->
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5ec8dede38a031be"></script>

</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light nav-distance">
        <a class="navbar-brand" href="#">절세미남미녀상 테스트</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item active">
                    <a class="nav-link" href="#">절세미남미녀상 테스트
                        <span class="sr-only">(current)</span>
                    </a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="https://teachablemachine.withgoogle.com/">Teachable Machine</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="https://github.com/">GitHub</a>
                </li>
            </ul>
        </div>
    </nav>
    <section class="section">
        <h1 class="title">절세미남미녀상 테스트</h1>
        <h2 class="subtitle">인공지능으로 알아보는 내가 닮은 절세 미남 또는 절세 미녀 배우는 누구?</h2>
    </section>
    <h3 class="pb-2 d-flex justify-content-center">성별을 선택하세요</h3>
    <section class="section-gender d-flex justify-content-center">
        <p class="d-flex align-items-center pr-3">여자</p>
        <div>
            <input type="checkbox" id="gender">
            <label for="gender">
                <span class="knob">
                    <i></i>
                </span>
            </label>
        </div>
        <p class="d-flex align-items-center pl-3">남자</p>
    </section>
    <script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <div class="mt-3 container file-upload">
        <div class="image-upload-wrap">
            <input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
            <div class="drag-text">
                <img src="img/upload.svg" class="mt-5 pt-5 upload">
                <h3 class="mb-5 pb-5 pt-4 upload-text">얼굴 사진을 올려놓거나 눌러서 업로드하세요!</h3>
            </div>
        </div>
        <div class="file-upload-content">
            <img class="file-upload-image" id="face-image" src="#" alt="your image" />
            <div id="loading" class="animated bounce">
                <div class="spinner-border" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
                <p class="text-center">AI가 당신이 닮은 배우를 찾고 있습니다.</p>
            </div>
            <p class="result-message"></p>
            <div id="label-container"></div>

            <!-- Go to www.addthis.com/dashboard to customize your tools -->
            <div class="addthis_inline_share_toolbox"></div>
            <div class="pt-3 image-title-wrap">
                <button type="button p-2" class="try-again-btn" onclick="window.location.reload();">
                    <span class="try-again-text">다른 사진으로 재시도</span>
                </button>
            </div>

        </div>
    </div>
    <section class="youtube pb-3">
        <div class="container mt-3 youtube-cover d-flex flex-row-reverse align-items-center">
            <img src="img/youtube-copy.jpg" alt="youtube-icon" class="youtube-icon">
            <a href="https://www.youtube.com/channel/UCQNE2JmbasNYbjGAcuBiRRg" class="youtube-link">제작 도움: 조코딩 유튜브 채널</a>
        </div>
    </section>
    <section class="favicon pb-3">
        <div class="container d-flex flex-row-reverse align-items-center"><a href="https://www.flaticon.com/kr/" title="Flaticon">icon made by Freepik from www.flaticon.com</a></div>
    </section>
    <div id="disqus_thread"></div>
    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document,
                s = d.createElement('script');
            s.src = 'https://navigipsa.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the
        <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
    <footer class="footer pt-5 container d-flex justify-content-center">
        <div>
            <p>&copy; HappyQ 2020. All Rights Reserved.</p>
        </div>
    </footer>
    <script>
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    $('.image-upload-wrap').hide();
                    $('#loading').show();
                    $('.file-upload-image').attr('src', e.target.result);
                    $('.file-upload-content').show();
                    $('.image-title').html(input.files[0].name);
                };
                reader.readAsDataURL(input.files[0]);
                init().then(() => {
                    predict();
                    $('#loading').hide();
                });
            } else {
                removeUpload();
            }
        }

        function removeUpload() {
            $('.file-upload-input').replaceWith($('.file-upload-input').clone());
            $('.file-upload-content').hide();
            $('.image-upload-wrap').show();
        }
        $('.image-upload-wrap').bind('dragover', function() {
            $('.image-upload-wrap').addClass('image-dropping');
        });
        $('.image-upload-wrap').bind('dragleave', function() {
            $('.image-upload-wrap').removeClass('image-dropping');
        });
    </script>
    <script type="text/javascript">
        // More API functions here:
        // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image
        // the link to your model provided by Teachable Machine export panel
        let URL;
        const urlMale = "https://teachablemachine.withgoogle.com/models/FOOVJpA4X/";
        const urlFemale = "https://teachablemachine.withgoogle.com/models/vl5MZInwG/";
        let model, webcam, labelContainer, maxPredictions;
        async function init() {
            if (document.getElementById("gender").checked) {
                URL = urlMale;
            } else {
                URL = urlFemale;
            }
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";
            // load the model and metadata
            // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
            // or files from your local hard drive
            // Note: the pose library adds "tmImage" object to your window (window.tmImage)
            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();
            labelContainer = document.getElementById("label-container");
            for (let i = 0; i < maxPredictions; i++) {
                var element = document.createElement("div")
                element.classList.add("d-flex");
                labelContainer.appendChild(element);
                // labelContainer.appendChild(document.createElement("div"));
            }
        }
        async function predict() {
            var image = document.getElementById("face-image");
            const prediction = await model.predict(image, false);
            prediction.sort((a, b) => parseFloat(b.probability) - parseFloat(a.probability));
            console.log(prediction[0].className);
            var resultTitle, resultExplain;
            if (document.getElementById("gender").checked) {
                switch (prediction[0].className) {
                    case "고수":
                        resultTitle = "Great~~당신은 고비드, 고수를 닮았군요!"
                        resultExplain = "굵은 이목구비와 비단처럼 고운 선을 가져 아름다움도 겸비한 고비드, 고수를 닮은 당신은 조각 미남"
                        break;
                    case "송승헌":
                        resultTitle = "Amazing~~당신은 송충이 눈썹, 송승헌을 닮았군요!"
                        resultExplain = "매력적인 진한 눈썹과 뚜렷한 얼굴선을 가진 송승헌을 닮은 당신은 전형적인 남자다운 미남"
                        break;
                    case "원빈":
                        resultTitle = "Incredible~~당신은 대한민국 대표 꽃미남, 원빈을 닮았군요!"
                        resultExplain = "사슴 같은 눈망울에 만화에서나 나올 법한 외모의 원빈을 닮은 당신은 엄청난 꽃미남"
                        break;
                    case "정우성":
                        resultTitle = "Wow~~당신은 짜릿하고 늘 새로운 잘생긴 게 최고인 정우성을 닮았군요!"
                        resultExplain = "잘생김의 대표, 정우성을 닮은 당신은 말로 표현하기 어려울 정도로 멋있는 미남"
                        break;
                    case "현빈":
                        resultTitle = "Awesome~~당신은 시크릿 가든의 현빈을 닮았군요!"
                        resultExplain = "짙은 속쌍꺼풀, 오뚝한 콧대, 도톰한 입술의 현빈을 닮은 당신은 세련미가 넘쳐흐르는 매력적인 미남"
                        break;
                }
            } else {
                switch (prediction[0].className) {
                    case "김태희":
                        resultTitle = "Incredible~~당신은 대한민국 대표 미녀 김태희를 닮았군요!"
                        resultExplain = "갸름한 얼굴형에 눈, 코, 입이 조화롭게 어우러져 미녀상을 대표하는 김태희를 닮은 당신은 황금비율을 가진 자연미인"
                        break;
                    case "손예진":
                        resultTitle = "Great~~당신은 청순의 대명사인 여름향기의 손예진을 닮았군요!"
                        resultExplain = "사슴 같은 눈에 두툼한 눈 밑 애교 살로 사랑스러운 눈웃음을 짓는 손예진을 닮은 당신은 청순가련 미인"
                        break;
                    case "송혜교":
                        resultTitle = "Wow~~당신은 원조 한류 스타인 가을동화의 송혜교를 닮았군요!"
                        resultExplain = "완벽에 가깝다는 좌우대칭 얼굴을 가진 송혜교를 닮은 당신은 맑고 투명한 피부를 가진 동안의 사랑스러운 미인"
                        break;
                    case "수지":
                        resultTitle = "Awesome~~당신은 국민 첫사랑 수지를 닮았군요!"
                        resultExplain = "대한민국 20대 여배우 중 대표 미인인 수지를 닮은 당신은 정말 예쁜 눈에 자연스럽고 매력적인 눈웃음까지 가진 상큼발랄한 미인"
                        break;
                    case "이영애":
                        resultTitle = "Amazing~~당신은 전설의 대장금 이영애를 닮았군요!"
                        resultExplain = "시대를 초월하는 신비로운 매력을 가진 이영애를 닮은 당신은 동서양의 미가 공존하는 우아한 미인"
                        break;
                }
            }
            var title = "<div class='" + prediction[0].className + "-actor-title'>" + resultTitle + "</div>"
            var explain = "<div class='actor-explain pt-2'>" + resultExplain + "</div>"
            $('.result-message').html(title + explain);
            var barWidth;
            for (let i = 0; i < maxPredictions; i++) {
                if (prediction[i].probability.toFixed(2) > 0.1) {
                    barWidth = Math.round(prediction[i].probability.toFixed(2) * 100) + "%";
                } else if (prediction[i].probability.toFixed(2) >= 0.01) {
                    barWidth = "4%"
                } else {
                    barWidth = "2%"
                }
                var labelTitle;
                switch (prediction[i].className) {
                    case "고수":
                        labelTitle = "고수"
                        break;
                    case "송승헌":
                        labelTitle = "송승헌"
                        break;
                    case "원빈":
                        labelTitle = "원빈"
                        break;
                    case "정우성":
                        labelTitle = "정우성"
                        break;
                    case "현빈":
                        labelTitle = "현빈"
                        break;
                    case "김태희":
                        labelTitle = "김태희"
                        break;
                    case "손예진":
                        labelTitle = "손예진"
                        break;
                    case "송혜교":
                        labelTitle = "송혜교"
                        break;
                    case "수지":
                        labelTitle = "수지"
                        break;
                    case "이영애":
                        labelTitle = "이영애"
                        break;
                }
                var label = "<div class='actor-label d-flex align-items-center'>" + labelTitle + "</div>"
                var bar = "<div class='bar-container position-relative container'><div class='" + prediction[i].className + "-box'></div><div class='d-flex justify-content-center align-items-center " + prediction[i].className + "-bar' style='width: " + barWidth + "'><span class='d-block percent-text'>" + Math.round(prediction[i].probability.toFixed(2) * 100) + "%</span></div></div>"
                labelContainer.childNodes[i].innerHTML = label + bar;
                // const classPrediction =
                //    prediction[i].className + ": " + prediction[i].probability.toFixed(2);
                // labelContainer.childNodes[i].innerHTML = classPrediction;
            }
        }
    </script>

</body>
<!-- 
image input box
Copyright (c) 2020 by Aaron Vanston (https://codepen.io/aaronvanston/pen/yNYOXR)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. 

gender toggle
Copyright (c) 2020 by Mert Cukuren (https://codepen.io/knyttneve/pen/bPpEZY)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-->

</html>